<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VueæŠ€æœ¯çŸ¥è¯†å›¾è°±</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: 'Inter', 'Segoe UI', sans-serif;
            background-color: #0f172a;
            color: #e2e8f0;
            margin: 0;
            overflow: hidden;
        }

        #app {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            padding: 1.2rem;
            background: rgba(15, 23, 42, 0.9);
            border-bottom: 1px solid #1e293b;
            z-index: 10;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        .header h1 {
            margin: 0;
            font-weight: 700;
            font-size: 1.5rem;
            text-align: center;
            background: linear-gradient(90deg, #4f46e5, #8b5cf6);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .container {
            flex: 1;
            position: relative;
        }

        #graph {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }

        .controls {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 100;
            display: flex;
            flex-direction: column;
            gap: 10px;
            background: rgba(15, 23, 42, 0.8);
            padding: 12px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        .controls button {
            background: rgba(30, 41, 59, 0.7);
            color: #94a3b8;
            border: 1px solid #334155;
            border-radius: 6px;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            transition: all 0.2s;
        }

        .controls button:hover {
            background: rgba(56, 189, 248, 0.2);
            color: #38bdf8;
            border-color: #38bdf8;
        }

        .controls button i {
            margin-right: 6px;
        }

        .node {
            fill: #94a3b8;
            stroke: #0ea5e9;
            stroke-width: 1.5;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .node.core {
            fill: #8b5cf6;
            stroke: #c4b5fd;
            stroke-width: 2.5;
        }

        .node.programming {
            fill: #38bdf8;
            stroke: #7dd3fc;
        }

        .node.framework {
            fill: #10b981;
            stroke: #6ee7b7;
        }

        .node.tool {
            fill: #f59e0b;
            stroke: #fcd34d;
        }

        .node:hover {
            stroke-width: 3;
            filter: drop-shadow(0 0 8px currentColor);
            transform: scale(1.05);
        }

        .node-label {
            fill: #e2e8f0;
            font-size: 13px;
            font-weight: 600;
            text-anchor: middle;
            dominant-baseline: middle;
            pointer-events: none;
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.8);
            transition: all 0.3s;
        }

        .link {
            stroke: #475569;
            stroke-opacity: 0.6;
            stroke-width: 1.5;
            transition: all 0.3s;
        }

        .info-panel {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(15, 23, 42, 0.85);
            backdrop-filter: blur(10px);
            border: 1px solid #334155;
            border-radius: 10px;
            padding: 15px 20px;
            width: 80%;
            max-width: 500px;
            z-index: 100;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
        }

        .info-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid #334155;
        }

        .info-title {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 700;
            color: #38bdf8;
        }

        .info-content {
            color: #cbd5e1;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .close-btn {
            background: transparent;
            border: none;
            color: #94a3b8;
            font-size: 1.3rem;
            cursor: pointer;
            transition: color 0.2s;
        }

        .close-btn:hover {
            color: #f87171;
        }

        .watermark {
            position: absolute;
            bottom: 10px;
            right: 10px;
            color: #475569;
            font-size: 0.8rem;
            z-index: 100;
        }
    </style>
</head>
<body>
<div id="app">


    <div class="container">
        <div id="graph"></div>

<!--        <div class="controls">
            <button @click="resetZoom()">
                <i>ğŸ”</i> é‡ç½®ç¼©æ”¾
            </button>
            <button @click="simulation.restart()">
                <i>ğŸ”„</i> é‡æ–°å¸ƒå±€
            </button>
        </div>-->

<!--        <div v-if="selectedNode" class="info-panel">
            <div class="info-header">
                <h2 class="info-title">{{ selectedNode.name }}</h2>
                <button class="close-btn" @click="deselectNode">Ã—</button>
            </div>
            <div class="info-content">
                <p>{{ getNodeDescription(selectedNode) }}</p>
                <div v-if="selectedNode.connections" class="connections mt-3">
                    <strong>å…³è”æŠ€æœ¯: </strong>
                    <span v-for="(conn, i) in selectedNode.connections" :key="i">
              {{ conn }}{{ i < selectedNode.connections.length - 1 ? 'ã€' : '' }}
            </span>
                </div>
            </div>
        </div>-->

<!--        <div class="watermark">
            æŠ€æœ¯å›¾è°± Â© {{ new Date().getFullYear() }} Kokoro
        </div>-->
    </div>
</div>

<script>
    new Vue({
        el: '#app',
        data() {
            return {
                selectedNode: null,
                nodes: [],
                links: [],
                simulation: null,
                svg: null,
                width: 0,
                height: 0,
                categories: {
                    core: { color: '#8b5cf6' },
                    programming: { color: '#38bdf8' },
                    framework: { color: '#10b981' },
                    tool: { color: '#f59e0b' },
                    protocol: { color: '#ec4899' },
                    concept: { color: '#6366f1' }
                }
            }
        },
        mounted() {
            this.initGraph();
            this.initSimulation();
            this.initZoom();
            window.addEventListener('resize', this.updateDimensions);
        },
        beforeDestroy() {
            if (this.simulation) this.simulation.stop();
            window.removeEventListener('resize', this.updateDimensions);
        },
        methods: {
            initGraph() {
                // è·å–å®¹å™¨å°ºå¯¸
                const container = document.querySelector('.container');
                this.width = container.clientWidth;
                this.height = container.clientHeight;

                // åˆ›å»ºSVGå…ƒç´ 
                this.svg = d3.select('#graph')
                    .append('svg')
                    .attr('width', this.width)
                    .attr('height', this.height)
                    .append('g');

                // å®šä¹‰ç®­å¤´æ ‡è®°
                this.svg.append('defs').append('marker')
                    .attr('id', 'arrowhead')
                    .attr('viewBox', '-0 -5 10 10')
                    .attr('refX', 15)
                    .attr('refY', 0)
                    .attr('orient', 'auto')
                    .attr('markerWidth', 6)
                    .attr('markerHeight', 6)
                    .append('path')
                    .attr('d', 'M0,-5L10,0L0,5')
                    .attr('fill', '#64748b');

                // åˆ›å»ºæ¨¡æ‹Ÿæ•°æ®
                this.createData();

                // ç»˜åˆ¶åˆå§‹å›¾è¡¨
                this.renderGraph();
            },

            updateDimensions() {
                const container = document.querySelector('.container');
                this.width = container.clientWidth;
                this.height = container.clientHeight;

                d3.select('#graph svg')
                    .attr('width', this.width)
                    .attr('height', this.height);

                if (this.simulation) {
                    this.simulation.force('center', d3.forceCenter(this.width / 2, this.height / 2))
                    this.simulation.alpha(1).restart();
                }
            },

            createData() {
                // å®šä¹‰æŠ€æœ¯èŠ‚ç‚¹
                this.nodes = [
                    { id: 'README', name: 'README', category: 'core', radius: 24 },
                    { id: 'Vue', name: 'Vue', category: 'framework', radius: 20 },
                    { id: 'JavaScript', name: 'JavaScript', category: 'programming', radius: 18 },
                    { id: 'Java', name: 'Java', category: 'programming', radius: 18 },
                    { id: 'C++', name: 'C++', category: 'programming', radius: 18 },
                    { id: 'Python', name: 'Python', category: 'programming', radius: 18 },
                    { id: 'Kotlin', name: 'Kotlin', category: 'programming', radius: 18 },
                    { id: 'git', name: 'git', category: 'tool', radius: 16 },
                    { id: 'Android', name: 'Android', category: 'framework', radius: 20 },
                    { id: 'Flutter', name: 'Flutter', category: 'framework', radius: 18 },
                    { id: 'Compose', name: 'Compose', category: 'framework', radius: 16 },
                    { id: 'View', name: 'View', category: 'concept', radius: 14 },
                    { id: 'Viewç»˜åˆ¶', name: 'Viewç»˜åˆ¶', category: 'concept', radius: 14 },
                    { id: 'TCP', name: 'TCP', category: 'protocol', radius: 14 },
                    { id: 'UDP', name: 'UDP', category: 'protocol', radius: 14 },
                    { id: 'ç½‘ç»œ', name: 'ç½‘ç»œ', category: 'concept', radius: 16 },
                    { id: 'æ­£åˆ™è¡¨è¾¾å¼', name: 'æ­£åˆ™è¡¨è¾¾å¼', category: 'tool', radius: 16 },
                    { id: 'è¯­æ³•', name: 'è¯­æ³•', category: 'concept', radius: 14 },
                    { id: 'Gradle', name: 'Gradle', category: 'tool', radius: 16 },
                    { id: 'AOSP', name: 'AOSP', category: 'framework', radius: 16 },
                    { id: 'adb', name: 'adb', category: 'tool', radius: 14 }
                ];

                // å®šä¹‰èŠ‚ç‚¹ä¹‹é—´çš„å…³è”å…³ç³»
                this.links = [
                    { source: 'README', target: 'Vue', value: 5 },
                    { source: 'README', target: 'Java', value: 4 },
                    { source: 'README', target: 'git', value: 4 },
                    { source: 'README', target: 'Android', value: 3 },
                    { source: 'Vue', target: 'JavaScript', value: 5 },
                    { source: 'Vue', target: 'git', value: 3 },
                    { source: 'Vue', target: 'æ­£åˆ™è¡¨è¾¾å¼', value: 2 },
                    { source: 'Vue', target: 'è¯­æ³•', value: 3 },
                    { source: 'Java', target: 'Android', value: 4 },
                    { source: 'Java', target: 'Gradle', value: 3 },
                    { source: 'Android', target: 'Kotlin', value: 4 },
                    { source: 'Android', target: 'View', value: 3 },
                    { source: 'Android', target: 'Compose', value: 4 },
                    { source: 'Android', target: 'adb', value: 3 },
                    { source: 'Android', target: 'AOSP', value: 3 },
                    { source: 'View', target: 'Viewç»˜åˆ¶', value: 5 },
                    { source: 'Python', target: 'æ­£åˆ™è¡¨è¾¾å¼', value: 4 },
                    { source: 'C++', target: 'Viewç»˜åˆ¶', value: 3 },
                    { source: 'ç½‘ç»œ', target: 'TCP', value: 5 },
                    { source: 'ç½‘ç»œ', target: 'UDP', value: 4 },
                    { source: 'Flutter', target: 'Compose', value: 4 },
                    { source: 'git', target: 'è¯­æ³•', value: 2 }
                ];
            },

            initSimulation() {
                // åˆ›å»ºåŠ›å¯¼å‘å›¾æ¨¡æ‹Ÿ
                this.simulation = d3.forceSimulation(this.nodes)
                    .force('link', d3.forceLink(this.links).id(d => d.id).distance(d => 100 - d.value * 5))
                    .force('charge', d3.forceManyBody().strength(-400))
                    .force('center', d3.forceCenter(this.width / 2, this.height / 2))
                    .force('collision', d3.forceCollide().radius(d => d.radius + 5))
                    .on('tick', this.ticked);

                // åœ¨READMEèŠ‚ç‚¹ä¸Šæ·»åŠ åˆå§‹é€Ÿåº¦ï¼Œè®©å…¶ä»–èŠ‚ç‚¹æ•£å¼€
                const readmeNode = this.nodes.find(n => n.id === 'README');
                if (readmeNode) {
                    this.simulation.alpha(1).restart();
                }
            },

            initZoom() {
                // æ·»åŠ ç¼©æ”¾å’Œå¹³ç§»åŠŸèƒ½
                const zoom = d3.zoom()
                    .scaleExtent([0.1, 5])
                    .on('zoom', (event) => {
                        this.svg.attr('transform', event.transform);
                    });

                d3.select('#graph svg').call(zoom);
            },

            renderGraph() {
                // ç»˜åˆ¶è¿çº¿
                const link = this.svg.selectAll('.link')
                    .data(this.links)
                    .enter()
                    .append('line')
                    .attr('class', 'link')
                    .attr('marker-end', 'url(#arrowhead)');

                // ç»˜åˆ¶èŠ‚ç‚¹
                const node = this.svg.selectAll('.node')
                    .data(this.nodes)
                    .enter()
                    .append('circle')
                    .attr('class', d => `node node-${d.category}`)
                    .attr('r', d => d.radius)
                    .on('click', (event, d) => this.selectNode(event, d))
                    .call(d3.drag()
                        .on('start', (event, d) => {
                            if (!event.active) this.simulation.alphaTarget(0.3).restart();
                            d.fx = d.x;
                            d.fy = d.y;
                        })
                        .on('drag', (event, d) => {
                            d.fx = event.x;
                            d.fy = event.y;
                        })
                        .on('end', (event, d) => {
                            if (!event.active) this.simulation.alphaTarget(0);
                            d.fx = null;
                            d.fy = null;
                        })
                    );

                // æ·»åŠ èŠ‚ç‚¹æ ‡ç­¾
                const labels = this.svg.selectAll('.node-label')
                    .data(this.nodes)
                    .enter()
                    .append('text')
                    .attr('class', 'node-label')
                    .text(d => d.name)
                    .attr('dy', d => d.radius + 15);
            },

            ticked() {
                // æ›´æ–°èŠ‚ç‚¹å’Œè¿çº¿çš„ä½ç½®
                this.svg.selectAll('.link')
                    .attr('x1', d => d.source.x)
                    .attr('y1', d => d.source.y)
                    .attr('x2', d => d.target.x)
                    .attr('y2', d => d.target.y);

                this.svg.selectAll('.node')
                    .attr('cx', d => d.x)
                    .attr('cy', d => d.y);

                this.svg.selectAll('.node-label')
                    .attr('x', d => d.x)
                    .attr('y', d => d.y);
            },

            resetZoom() {
                // é‡ç½®ç¼©æ”¾å’Œå¹³ç§»
                d3.select('#graph svg').transition()
                    .duration(750)
                    .call(d3.zoom().transform, d3.zoomIdentity);
            },

            selectNode(event, node) {
                this.selectedNode = node;
                event.stopPropagation();

                // æ·»åŠ é«˜äº®æ•ˆæœ
                this.highlightNode(node);
            },

            deselectNode() {
                this.selectedNode = null;
                this.clearHighlights();
            },

            highlightNode(node) {
                // æ¸…é™¤æ‰€æœ‰é«˜äº®
                this.clearHighlights();

                // é«˜äº®å½“å‰èŠ‚ç‚¹
                d3.select(`circle.node[node-id="${node.id}"]`)
                    .classed('node-highlight', true);

                // é«˜äº®ç›¸å…³èŠ‚ç‚¹
                const relatedNodeIds = [
                    ...this.links.filter(l => l.source.id === node.id).map(l => l.target.id),
                    ...this.links.filter(l => l.target.id === node.id).map(l => l.source.id)
                ];

                relatedNodeIds.forEach(id => {
                    d3.select(`circle.node[node-id="${id}"]`)
                        .classed('node-related', true);
                });

                // é«˜äº®ç›¸å…³è¿çº¿
                const relatedLinks = [
                    ...this.links.filter(l => l.source.id === node.id),
                    ...this.links.filter(l => l.target.id === node.id)
                ];

                relatedLinks.forEach(link => {
                    d3.select(`line.link[source="${link.source.id}"][target="${link.link.id}"]`)
                        .classed('link-highlight', true);
                });
            },

            clearHighlights() {
                d3.selectAll('.node-highlight').classed('node-highlight', false);
                d3.selectAll('.node-related').classed('node-related', false);
                d3.selectAll('.link-highlight').classed('link-highlight', false);
            },

            getNodeDescription(node) {
                const descriptions = {
                    'README': 'ç³»ç»Ÿæ ¸å¿ƒèŠ‚ç‚¹ï¼Œè¿æ¥æ‰€æœ‰æŠ€æœ¯æ¦‚å¿µ',
                    'Vue': 'æ¸è¿›å¼JavaScriptæ¡†æ¶ï¼Œç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢',
                    'JavaScript': 'é«˜çº§ç¼–ç¨‹è¯­è¨€ï¼Œç”¨äºç½‘é¡µäº¤äº’å’ŒåŠ¨æ€å†…å®¹',
                    'Java': 'é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ï¼Œå¹¿æ³›ç”¨äºä¼ä¸šçº§å¼€å‘',
                    'C++': 'é«˜æ€§èƒ½ç¼–ç¨‹è¯­è¨€ï¼Œç”¨äºç³»ç»Ÿå¼€å‘å’Œé«˜æ€§èƒ½è®¡ç®—',
                    'Python': 'é€šç”¨ç¼–ç¨‹è¯­è¨€ï¼Œæ³¨é‡å¯è¯»æ€§å’Œå¼€å‘æ•ˆç‡',
                    'Kotlin': 'ç°ä»£ç¼–ç¨‹è¯­è¨€ï¼Œé€‚ç”¨äºAndroidå¼€å‘',
                    'git': 'åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œç”¨äºè·Ÿè¸ªä»£ç å˜æ›´',
                    'Android': 'åŸºäºLinuxçš„ç§»åŠ¨æ“ä½œç³»ç»Ÿï¼Œæ”¯æŒå„ç§è®¾å¤‡',
                    'Flutter': 'Googleå¼€å‘çš„å¼€æºUIæ¡†æ¶ï¼Œç”¨äºåˆ›å»ºè·¨å¹³å°åº”ç”¨',
                    'Compose': 'ç°ä»£å£°æ˜å¼UIå·¥å…·åŒ…ï¼Œç”¨äºAndroidåŸç”Ÿå¼€å‘',
                    'View': 'ç”¨æˆ·ç•Œé¢å…ƒç´ çš„åŸºæœ¬æ„å»ºå—',
                    'Viewç»˜åˆ¶': 'ç•Œé¢æ¸²æŸ“è¿‡ç¨‹å’Œæ€§èƒ½ä¼˜åŒ–æŠ€æœ¯',
                    'TCP': 'ä¼ è¾“æ§åˆ¶åè®®ï¼Œæä¾›å¯é çš„æœ‰åºæ•°æ®ä¼ è¾“',
                    'UDP': 'ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼Œæä¾›ç®€å•æ— è¿æ¥ä¼ è¾“',
                    'ç½‘ç»œ': 'è®¡ç®—è®¾å¤‡äº’è¿ç³»ç»Ÿï¼Œç”¨äºèµ„æºå’ŒæœåŠ¡å…±äº«',
                    'æ­£åˆ™è¡¨è¾¾å¼': 'æ–‡æœ¬æ¨¡å¼åŒ¹é…æŠ€æœ¯ï¼Œç”¨äºæœç´¢å’Œæ“ä½œå­—ç¬¦ä¸²',
                    'è¯­æ³•': 'ç¼–ç¨‹è¯­è¨€çš„ç»“æ„åŒ–è§„åˆ™å’Œå½¢å¼å®šä¹‰',
                    'Gradle': 'æ„å»ºè‡ªåŠ¨åŒ–å·¥å…·ï¼Œæ”¯æŒå¤šç§è¯­è¨€å’Œå¹³å°',
                    'AOSP': 'Androidå¼€æºé¡¹ç›®ï¼Œæä¾›å®Œæ•´çš„æ“ä½œç³»ç»Ÿä»£ç ',
                    'adb': 'Androidè°ƒè¯•æ¡¥ï¼Œå¼€å‘è€…è®¾å¤‡ç®¡ç†å·¥å…·'
                };

                return descriptions[node.id] || `è¿™æ˜¯æŠ€æœ¯çŸ¥è¯†å›¾è°±ä¸­çš„${node.name}èŠ‚ç‚¹`;
            }
        }
    });
</script>
</body>
</html>